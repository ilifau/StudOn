il.COPagePres={init:function(){this.initToc();this.initInteractiveImages();this.updateQuestionOverviews();this.initMapAreas();this.initAdvancedContent();this.initAudioVideo()},initToc:function(){var cookiePos=document.cookie.indexOf("pg_hidetoc=");if(cookiePos>-1&&document.cookie.charAt(cookiePos+11)==1){this.toggleToc()}},toggleToc:function(){var toc_on,toc_off,toc=document.getElementById("ilPageTocContent");if(!toc){return}toc_on=document.getElementById("ilPageTocOn");toc_off=document.getElementById("ilPageTocOff");if(toc&&toc.style.display=="none"){toc.style.display="block";toc_on.style.display="none";toc_off.style.display="";document.cookie="pg_hidetoc=0"}else{toc_on.style.display="";toc_off.style.display="none";toc.style.display="none";document.cookie="pg_hidetoc=1"}},iim_trigger:{},iim_area:{},iim_popup:{},iim_marker:{},dragging:false,initInteractiveImages:function(){$("map.iim > area").mouseover(this.overBaseArea);$("map.iim > area").mouseout(this.outBaseArea);$("map.iim > area").click(this.clickBaseArea);$("a.ilc_marker_Marker").mouseover(this.overMarker);$("a.ilc_marker_Marker").mouseout(this.outMarker);$("a.ilc_marker_Marker").click(this.clickMarker)},overMarker:function(e){var marker_tr_nr,iim_id;if(this.dragging){return}marker_tr_nr=il.COPagePres.iim_marker[e.target.id].tr_nr;iim_id=il.COPagePres.iim_marker[e.target.id].iim_id;il.COPagePres.handleOverEvent(iim_id,marker_tr_nr,true)},outMarker:function(e){var marker_tr_nr,iim_id;if(this.dragging){return}marker_tr_nr=il.COPagePres.iim_marker[e.target.id].tr_nr;iim_id=il.COPagePres.iim_marker[e.target.id].iim_id;il.COPagePres.handleOutEvent(iim_id,marker_tr_nr)},overBaseArea:function(e){var area_tr_nr=il.COPagePres.iim_area[e.target.id].tr_nr,iim_id=il.COPagePres.iim_area[e.target.id].iim_id;il.COPagePres.handleOverEvent(iim_id,area_tr_nr,false)},handleOverEvent:function(iim_id,area_tr_nr,is_marker){var k,j,tr,coords,ovx,ovy,base,ov,base_map_name,c,k2,i2,tr2;if(this.dragging){return}for(k in il.COPagePres.iim_trigger){tr=il.COPagePres.iim_trigger[k];if(tr.nr==area_tr_nr&&tr.iim_id==iim_id){base=$("img#base_img_"+tr.iim_id);ov=$("img#iim_ov_"+tr.tr_id);if(ov.length==0){continue}if(typeof base.attr("usemap")==="undefined"){continue}base_map_name=base.attr("usemap").substr(1);ov.css("position","absolute");ovx=parseInt(tr.ovx,10);ovy=parseInt(tr.ovy,10);ov.css("display","");$(ov).position({my:"left top",at:"left+"+ovx+" top+"+ovy,of:"img#base_img_"+tr.iim_id,collision:"none"});if(tr.map_initialized==null&&!is_marker){tr.map_initialized=true;$("map[name='"+base_map_name+"'] > area").each(function(i,el){if(il.COPagePres.iim_area[el.id].tr_nr==area_tr_nr){coords=$(el).attr("coords");switch($(el).attr("shape").toLowerCase()){case"rect":c=coords.split(",");coords=String(parseInt(c[0],10)-ovx+","+(parseInt(c[1],10)-ovy)+","+(parseInt(c[2],10)-ovx)+","+(parseInt(c[3],10)-ovy));break;case"poly":c=coords.split(",");coords="";var sep="";for(j in c){if(j%2==0){coords=coords+sep+parseInt(c[j]-ovx,10)}else{coords=coords+sep+parseInt(c[j]-ovy,10)}sep=","}break;case"circle":c=coords.split(",");coords=String(parseInt(c[0],10)-ovx+","+(parseInt(c[1],10)-ovy)+","+parseInt(c[2],10));break}$("area#iim_ov_area_"+tr.tr_id).attr("coords",coords);$("area#iim_ov_area_"+tr.tr_id).attr("shape",$(el).attr("shape"));k2=k;i2="iim_ov_"+tr.tr_id;tr2=tr.tr_id;$("area#iim_ov_area_"+tr.tr_id).mouseover(function(){il.COPagePres.overOvArea(k2,true,i2)});$("area#iim_ov_area_"+tr.tr_id).mouseout(function(){il.COPagePres.overOvArea(k2,false,i2)});$("area#iim_ov_area_"+tr.tr_id).click(function(e){il.COPagePres.clickOvArea(e,tr2)})}})}}}},outBaseArea:function(e){var area_tr_nr=il.COPagePres.iim_area[e.target.id].tr_nr,iim_id=il.COPagePres.iim_area[e.target.id].iim_id;il.COPagePres.handleOutEvent(iim_id,area_tr_nr)},handleOutEvent:function(iim_id,area_tr_nr){var k,tr;if(this.dragging){return}for(k in il.COPagePres.iim_trigger){tr=il.COPagePres.iim_trigger[k];if(tr.nr==area_tr_nr&&tr.iim_id==iim_id&&(il.COPagePres.iim_trigger[k].over_ov_area==null||!il.COPagePres.iim_trigger[k].over_ov_area)){$("img#iim_ov_"+tr.tr_id).css("display","none")}}},overOvArea:function(k,value,ov_id){if(this.dragging){return}il.COPagePres.iim_trigger[k].over_ov_area=value;if(value){$("img#"+ov_id).css("display","")}else{$("img#"+ov_id).css("display","none")}},clickMarker:function(e){var k,tr,marker_tr_nr=il.COPagePres.iim_marker[e.target.id].tr_nr,iim_id=il.COPagePres.iim_marker[e.target.id].iim_id;if(il.COPagePres.iim_marker[e.target.id].edit_mode=="1"){return}if(this.dragging){return}for(k in il.COPagePres.iim_trigger){tr=il.COPagePres.iim_trigger[k];if(tr.nr==marker_tr_nr&&tr.iim_id==iim_id){il.COPagePres.handleAreaClick(e,tr.tr_id)}}},clickBaseArea:function(e){var k,tr,area_tr_nr=il.COPagePres.iim_area[e.target.id].tr_nr,iim_id=il.COPagePres.iim_area[e.target.id].iim_id;if(this.dragging){return}for(k in il.COPagePres.iim_trigger){tr=il.COPagePres.iim_trigger[k];if(tr.nr==area_tr_nr&&tr.iim_id==iim_id){il.COPagePres.handleAreaClick(e,tr.tr_id)}}},handleAreaClick:function(e,tr_id){var tr=il.COPagePres.iim_trigger[tr_id],el=document.getElementById("iim_popup_"+tr.iim_id+"_"+tr.popup_nr),base,pos,x,y;if(el==null||this.dragging){e.preventDefault();return}if(tr.popup_initialized==null){tr.popup_initialized=true;il.Overlay.add("iim_popup_"+tr.iim_id+"_"+tr.popup_nr,{yuicfg:{visible:false,fixedcenter:false},auto_hide:false})}base=$("img#base_img_"+il.COPagePres.iim_trigger[tr_id].iim_id);pos=base.offset();x=pos.left+parseInt(il.COPagePres.iim_trigger[tr_id].popx,10);y=pos.top+parseInt(il.COPagePres.iim_trigger[tr_id].popy,10);il.Overlay.setWidth("iim_popup_"+tr.iim_id+"_"+tr.popup_nr,il.COPagePres.iim_trigger[tr_id].popwidth);il.Overlay.setHeight("iim_popup_"+tr.iim_id+"_"+tr.popup_nr,il.COPagePres.iim_trigger[tr_id].popheight);il.Overlay.toggle(e,"iim_popup_"+tr.iim_id+"_"+tr.popup_nr,null,false,null,null,"click");il.Overlay.setX("iim_popup_"+tr.iim_id+"_"+tr.popup_nr,x);il.Overlay.setY("iim_popup_"+tr.iim_id+"_"+tr.popup_nr,y);e.preventDefault()},clickOvArea:function(e,tr_id){il.COPagePres.handleAreaClick(e,tr_id)},addIIMTrigger:function(tr){this.iim_trigger[tr.tr_id]=tr},addIIMArea:function(a){this.iim_area[a.area_id]=a},addIIMPopup:function(p){this.iim_popup[p.pop_id]=p},addIIMMarker:function(m){var base,pos,mark,mx,my;this.iim_marker[m.m_id]=m;base=$("img#base_img_"+m.iim_id);pos=base.position();mark=$("a#"+m.m_id);mark.css("position","absolute");mx=parseInt(m.markx,10);my=parseInt(m.marky,10);mark.css("left",pos.left+mx+$("#fixed_content").scrollLeft());mark.css("top",pos.top+my+$("#fixed_content").scrollTop());mark.css("display","")},fixMarkerPositions:function(){var m,k,base,pos,mark,mx,my;for(k in il.COPagePres.iim_marker){m=il.COPagePres.iim_marker[k];base=$("img#base_img_"+m.iim_id);pos=base.position();mark=$("a#"+m.m_id);mark.css("position","absolute");mx=parseInt(m.markx,10);my=parseInt(m.marky,10);mark.css("left",pos.left+mx+$("#fixed_content").scrollLeft());mark.css("top",pos.top+my+$("#fixed_content").scrollTop())}},startDraggingMarker:function(tr_nr){var k,mark;this.dragging=true;for(k in il.COPagePres.iim_marker){if(il.COPagePres.iim_marker[k].tr_nr==tr_nr){mark=il.COPagePres.iim_marker[k];$("a#"+il.COPagePres.iim_marker[k].m_id).css("display","");il.COPagePres.fixMarkerPositions();$("a#"+il.COPagePres.iim_marker[k].m_id).draggable({drag:function(event,ui){var base,bpos,marker,mpos,position;base=$("img#base_img_"+mark.iim_id);bpos=base.position();marker=$("a#"+mark.m_id);mpos=marker.position();position=Math.round(mpos.left)-Math.round(bpos.left)+","+(Math.round(mpos.top)-Math.round(bpos.top));$("input#markpos_"+mark.tr_nr).attr("value",position)}});il.COPagePres.initDragToolbar()}else{$("a#"+il.COPagePres.iim_marker[k].m_id).css("display","none")}}},stopDraggingMarker:function(){this.dragging=false},startDraggingOverlay:function(tr_nr){var k,trigger,dtr,ov,base,bpos,ovx,ovy;this.dragging=true;for(k in il.COPagePres.iim_trigger){trigger=il.COPagePres.iim_trigger[k];if(trigger.nr==tr_nr){dtr=trigger;ov=$("img#iim_ov_"+dtr.tr_id);ov.attr("usemap","");il.COPagePres.initDragToolbar();base=$("img#base_img_"+dtr.iim_id);bpos=base.position();ovx=parseInt(dtr.ovx,10);ovy=parseInt(dtr.ovy,10);ov.css("left",bpos.left+ovx+$("#fixed_content").scrollLeft());ov.css("top",bpos.top+ovy+$("#fixed_content").scrollTop());ov.css("display","");ov.css("position","absolute");dtr=trigger;ov.draggable({stop:function(event,ui){var ovpos,position;ovpos=ov.position();position=Math.round(ov.offset().left)-Math.round(base.offset().left)+","+(Math.round(ov.offset().top)-Math.round(base.offset().top));$("input#ovpos_"+dtr.nr).attr("value",position)}})}}},startDraggingPopup:function(tr_nr){var i,k,dtr,cpop,pdummy,base,bpos,popx,popy;this.dragging=true;for(k in il.COPagePres.iim_trigger){if(il.COPagePres.iim_trigger[k].nr==tr_nr){dtr=il.COPagePres.iim_trigger[k];for(i in il.COPagePres.iim_popup){if(il.COPagePres.iim_popup[i].nr==il.COPagePres.iim_trigger[k].popup_nr){cpop=il.COPagePres.iim_popup[i];pdummy=document.getElementById("popupdummy");if(pdummy==null){$("div#il_center_col").append('<div id="popupdummy" class="ilc_iim_ContentPopup"></div>');pdummy=$("div#popupdummy")}else{pdummy=$("div#popupdummy")}il.COPagePres.initDragToolbar();base=$("img#base_img_"+cpop.iim_id);bpos=base.position();popx=parseInt(dtr.popx,10);popy=parseInt(dtr.popy,10);pdummy.css("position","absolute");pdummy.css("left",bpos.left+popx+$("#fixed_content").scrollLeft());pdummy.css("top",bpos.top+popy+$("#fixed_content").scrollTop());pdummy.css("width",dtr.popwidth);pdummy.css("height",dtr.popheight);pdummy.css("display","");pdummy.draggable({stop:function(event,ui){var pdpos,position;pdpos=pdummy.position();position=Math.round(pdummy.offset().left)-Math.round(base.offset().left)+","+(Math.round(pdummy.offset().top)-Math.round(base.offset().top));$("input#poppos_"+dtr.nr).attr("value",position)}})}}}}},initDragToolbar:function(){$("#drag_toolbar").removeClass("ilNoDisplay");this.fixMarkerPositions();$("#save_pos_button").click(function(){$("input#update_tr_button").trigger("click")})},qover:{},ganswer_data:{},addQuestionOverview:function(conf){this.qover[conf.id]=conf},updateQuestionOverviews:function(){var correct={},incorrect={},correct_cnt=0,incorrect_cnt=0,answered_correctly,index,k,i,ov_el,ul,j,qtext;if(typeof questions==="undefined"){for(i in this.qover){ov_el=$("div#"+this.qover[i].div_id);$(ov_el).addClass("ilBox");$(ov_el).css("margin","5px");ov_el.empty();ov_el.append('<div class="il_Description_no_margin">'+ilias.questions.txt.ov_preview+"</div>")}return}for(k in questions){answered_correctly=true;index=parseInt(k,10);if(!isNaN(index)){if(!answers[index]){answered_correctly=false}else{if(answers[index].passed!=true){answered_correctly=false}}if(!answered_correctly){incorrect[k]=k;incorrect_cnt++}else{correct[k]=k;correct_cnt++}}}for(i in this.qover){ov_el=$("div#"+this.qover[i].div_id);ov_el.empty();if(incorrect_cnt==0){ov_el.attr("class","ilc_qover_Correct");ov_el.append(ilias.questions.txt.ov_all_correct)}else{ov_el.attr("class","ilc_qover_Incorrect");if(this.qover[i].short_message=="y"){ov_el.append('<div class="ilc_qover_StatusMessage">'+ilias.questions.txt.ov_some_correct.split("[x]").join(String(correct_cnt)).split("[y]").join(String(incorrect_cnt+correct_cnt))+"</div>")}if(this.qover[i].list_wrong_questions=="y"){ov_el.append('<div class="ilc_qover_WrongAnswersMessage">'+ilias.questions.txt.ov_wrong_answered+":"+"</div>");ov_el.append('<ul class="ilc_list_u_BulletedList"></ul>');ul=$("div#"+this.qover[i].div_id+" > ul");for(j in incorrect){qtext=questions[j].question;if(questions[j].type=="assClozeTest"){qtext=questions[j].title}ul.append('<li class="ilc_list_item_StandardListItem">'+'<a href="#" onclick="return il.COPagePres.jumpToQuestion(\''+j+'\');" class="ilc_qoverl_WrongAnswerLink">'+qtext+"</a>"+"</li>")}}}}},jumpToQuestion:function(qid){if(typeof pager!=="undefined"){pager.jumpToElement("container"+qid)}return false},setGivenAnswerData:function(data){ilCOPagePres.ganswer_data=data},initMapAreas:function(){$('img[usemap^="#map_il_"][class!="ilIim"]').maphilight({neverOn:true})},showadvcont:true,initAdvancedContent:function(){var c=$("div.ilc_section_AdvancedKnowledge"),b=$("#ilPageShowAdvContent"),cookiePos;if(c.length>0&&b.length>0){cookiePos=document.cookie.indexOf("pg_hideadv=");if(cookiePos>-1&&document.cookie.charAt(cookiePos+11)==1){this.showadvcont=false}$("#ilPageShowAdvContent").css("display","block");if(il.COPagePres.showadvcont){$("div.ilc_section_AdvancedKnowledge").css("display","");$("#ilPageShowAdvContent > span:nth-child(1)").css("display","none")}else{$("div.ilc_section_AdvancedKnowledge").css("display","none");$("#ilPageShowAdvContent > span:nth-child(2)").css("display","none")}$("#ilPageShowAdvContent").click(function(){if(il.COPagePres.showadvcont){$("div.ilc_section_AdvancedKnowledge").css("display","none");$("#ilPageShowAdvContent > span:nth-child(1)").css("display","");$("#ilPageShowAdvContent > span:nth-child(2)").css("display","none");il.COPagePres.showadvcont=false;document.cookie="pg_hideadv=1"}else{$("div.ilc_section_AdvancedKnowledge").css("display","");$("#ilPageShowAdvContent > span:nth-child(1)").css("display","none");$("#ilPageShowAdvContent > span:nth-child(2)").css("display","");il.COPagePres.showadvcont=true;document.cookie="pg_hideadv=0"}return false})}},initAudioVideo:function(acc_el){var $elements;if(acc_el){$elements=$(acc_el).find("video.ilPageVideo,audio.ilPageAudio")}else{$elements=$("video.ilPageVideo,audio.ilPageAudio")}if($elements.mediaelementplayer){$elements.each(function(i,el){var def,cfg;def=$(el).find("track[default='default']").first().attr("srclang");cfg={features:["playpause","current","progress","skipback","jumpforward","volume","fullscreen"],skipBackInterval:10,jumpForwardInterval:10};if(def!=""){cfg.startLanguage=def}$(el).mediaelementplayer(cfg)})}$("video").bind("contextmenu",function(e){return false});$("audio").bind("contextmenu",function(e){return false})},accordionRerender:function(acc_el){$(acc_el).find("video.ilPageVideo,audio.ilPageAudio").each(function(i,el){if(el.player)el.player.remove()});il.COPagePres.initAudioVideo(acc_el)}};il.Util.addOnLoad(function(){il.COPagePres.init()});